<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="High-pass filtering#Intro
Filtering is a complex process, and requires some thought and consideration. It&rsquo;s important that you read around on some literature on filtering to understand what you are doing to your data, and the consequences of inappropriate filtering (particularly see this paper for a fantastic overview of the issue). High-pass filtering - the type of filter that allows the higher amplitudes to pass through but cuts out the lower amplitudes - is a really important early step in your pre-processing pipeline.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="5. High-pass filtering" />
<meta property="og:description" content="High-pass filtering#Intro
Filtering is a complex process, and requires some thought and consideration. It&rsquo;s important that you read around on some literature on filtering to understand what you are doing to your data, and the consequences of inappropriate filtering (particularly see this paper for a fantastic overview of the issue). High-pass filtering - the type of filter that allows the higher amplitudes to pass through but cuts out the lower amplitudes - is a really important early step in your pre-processing pipeline." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://j-lewen.github.io/erp/docs/table-of-contents/training/part_5/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2023-07-15T12:43:25+01:00" />
<title>5. High-pass filtering | ERP Resources</title>
<link rel="manifest" href="/erp/manifest.json">
<link rel="icon" href="/erp/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/erp/book.min.4e9c835d588941dade0d826450d333312d45c30b834d56ec69a0b22b1ffbb9f9.css" integrity="sha256-TpyDXViJQdreDYJkUNMzMS1FwwuDTVbsaaCyKx/7ufk=" crossorigin="anonymous">
  <script defer src="/erp/flexsearch.min.js"></script>
  <script defer src="/erp/en.search.min.c41f7f11db491040deff170b9e4c3c368fc3687febb26e00e23f5a3ba8569442.js" integrity="sha256-xB9/EdtJEEDe/xcLnkw8No/DaH/rsm4A4j9aO6hWlEI=" crossorigin="anonymous"></script>

  <script defer src="/erp/sw.min.e29036b255ace43cfdfab781867fcd6e0525713bc11a5f56608d1782e7200e77.js" integrity="sha256-4pA2slWs5Dz9&#43;reBhn/NbgUlcTvBGl9WYI0XgucgDnc=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/erp/"><span>ERP Resources</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>



  



  
    
  



<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex justify-between">
      <a role="button" class="flex align-center">
        <img src="/erp/svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </label>

    <ul>
      
      <li>
        <a href="https://j-lewen.github.io/erp/zh/">
          Chinese
        </a>
      </li>
      
    </ul>
  </li>
</ul>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/" class="">About</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-aa6010235181e8c9d397ab55bc99d4ed" class="toggle" checked />
    <label for="section-aa6010235181e8c9d397ab55bc99d4ed" class="flex justify-between">
      <a href="/erp/docs/table-of-contents/training/" class="">ERP Training Resources</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_1/" class="">1. Getting started with ERPLAB</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_2/" class="">2. Importing data</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_3/" class="">3. Setting channel locations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_4/" class="">4. Resampling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_5/" class="active">5. High-pass filtering</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_6/" class="">6. Re-referencing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_7/" class="">7. Artifact correction (ICA)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_8/" class="">8. Interpolation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_9/" class="">9. Low-pass filter (optional)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_10/" class="">10. Epoch your data</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_11/" class="">11. Artifact rejection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_12/" class="">12. Averaging</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_13/" class="">13. Create difference waves (optional)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_14/" class="">14. Grand averaging</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_15/" class="">15. What next?</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/scripts/" class="">Scripts: Essential information</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/training/part_16/" class="">Appendix A</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/teaching/" class="">Teaching Material</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-02b6be880877da3da61cf051c9bcb238" class="toggle"  />
    <label for="section-02b6be880877da3da61cf051c9bcb238" class="flex justify-between">
      <a href="/erp/docs/table-of-contents/external/" class="">External Resources &amp; Publications</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/external/design/" class="">Designing your study</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/external/acquisition/" class="">Acquiring your data</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/external/preprocess/" class="">Pre-processing &amp; analysis</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/table-of-contents/external/writing/" class="">Writing your paper</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/erp/docs/contact/" class="">Contact</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/erp/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>5. High-pass filtering</strong>

  <label for="toc-control">
    
  </label>
</div>


  
 
      </header>

      
      
  <article class="markdown"><br>
<h3 id="high-pass-filtering">
  High-pass filtering
  <a class="anchor" href="#high-pass-filtering">#</a>
</h3>
 <br>
<p><u> Intro</u></p>
<p>Filtering is a complex process, and requires some thought and consideration. It&rsquo;s important that you read around on some literature on filtering to understand what you are doing to your data, and the consequences of inappropriate filtering (particularly see 
  <a href="https://www.researchgate.net/publication/273405257_How_inappropriate_high-pass_filters_can_produce_artifactual_effects_and_incorrect_conclusions_in_ERP_studies_of_language_and_cognition">this paper</a> for a fantastic overview of the issue).
High-pass filtering - the type of filter that allows the <strong>higher</strong> amplitudes to pass through but cuts out the lower amplitudes - is a really important early step in your pre-processing pipeline. But high-pass filtering can also cause substantial distortions of your data. So why do it?</p>
<p>
  <img src="/erp/images/drift.png" alt="drift" /></p>
<p>As you record EEG from a participant, you will often notice slow drifts in voltage that occur over time. These can be quite dramatic (as in the picture above) or occur very steadily. These drifts are caused by changes in the conductivity of the skin, which are fairly unavoidable - apart from ensuring your participants don&rsquo;t sweat excessively (see &lsquo;What if I have really sweaty participants?&rsquo; below). High pass filtering predominantly serves to reduce these slow drifts, although will not eliminate them completely.</p>
<p>As with all the other pre-processing steps, you will see plenty of examples in the literature of high-pass filtering done badly. But it is also not to be naive of the fact that <strong>all filters will distort your data</strong>. Because of this, it&rsquo;s crucial to select your filter carefully. If you take nothing else away from this tutorial, remember that:</p>
<ul>
<li>High-pass filtering should always be done on continuous data to avoid edge artifacts <!-- <a> element links to the section below --> <a href="#Section_further_down"> (1)</a></li>
<li>In most instances, a high-pass filter with a 0.1Hz cut-off (half-amplitude) or <em>lower</em> should be used;</li>
<li>Choosing your roll-off slope <a href="#Section_further_down"> (2)</a> is equally as important and selecting the right cut-off;</li>
<li>Filtering is almost always underreported. Don&rsquo;t be an underreporter.</li>
</ul>
<hr style="height:1px; visibility:hidden;" />
<u> Video</u>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/1cG_myhH13Y" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
<hr style="height:1px; visibility:hidden;" />
<u> Code</u>
<pre><code>    EEG  = pop_basicfilter( EEG,  [1:NUMBER OF ELECTRODES] , 'Boundary', 'boundary', 'Cutoff',  0.1, 'Design', 'butter', 'Filter', 'highpass', 'Order',  2 ); 
</code></pre>
<hr style="height:1px; visibility:hidden;" />
<u> Script</u>
<p>
  <a href="/erp/files/script_4.zip">Script #4</a> (download).</p>
<p>
  <a href="/erp/files/script_4.txt">Script #4</a> (view).</p>
<p>Note that to run this script you should use 
  <a href="https://drive.google.com/drive/folders/14ZlXqNKQVOCI1ZDHlCSHqVuea1CQlNMu?usp=sharing">Dataset #1</a> in its original .CNT form, as the script runs from the original continuous files (you need a different function to import .fdt and .set EEGLAB files)</p>
<hr style="height:1px; visibility:hidden;" />
<u> Dataset</u>
<p>To run this operation via the user interface, the example data set (used in the above video) can be downloaded 
  <a href="https://drive.google.com/drive/folders/1xNZs1Nm2bBqcFb9iIWOAxmgH1shKU3wj?usp=sharing">here</a></p>
<hr style="height:1px; visibility:hidden;" />
<u> Activity</u>
<p>Have a go at applying the filters both via the UI and with the provided script on Dataset_1. Play around with different filter settings and have a look at what different roll-off and cut-off thresholds do to the data. Finally, save your version of the script to your computer so as to ensure you have an up-to-date script for subsequent tutorial sections (and your own data analysis!).</p>
<hr style="height:1px; visibility:hidden;" />
<u> Write-up </u>
<hr style="height:1px; visibility:hidden;" />
<div class="write-up">
<blockquote>
<p>Continuous data was high-pass filtered offline, using an IIR Butterworth filter (2nd order) with a half-amplitude cut-off frequency of 0.1Hz and a and 12 dB/octave roll-off.</p>
</blockquote>
</div>
<hr style="height:1px; visibility:hidden;" />
<u>FAQ</u>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>I&#39;ve heard the terms &#39;online filter&#39; and &#39;offline filter&#39;. What do these mean?</span>
      <span>↕</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      Offline filters refer to pre-processing steps taken subsequent to data acquisition. Online filters are those applied during EEG recording (i.e., by your EEG data acquisition software.).
    </div>
  </label>
</div>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Can I use a different half-amplitude cut-off or slope?</span>
      <span>↕</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      Yes, but be careful with what you&rsquo;re doing, and be sure to read the recommended resources in &ldquo;What else should I know about filtering&rdquo; below. For a High-pass filter, you can use anything from 0.01 to 0.1 Hz (half-amplitude). A higher cut-off is better for datasets with more artifacts, whilst if your data is pretty clean you might want to sway closer to 0.05 or 0.01 Hz.
    </div>
  </label>
</div>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>What else should I know about filtering?</span>
      <span>↕</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      Filtering is a seemingly simple, but actually incredibly complex element of the pre-processing pipeline. It is important that you have a good understanding of what you&rsquo;re doing to your data, and how you can distort it by using the wrong setting. If you are new to filtering, I <em>strongly</em> recommend that you read Steve Luck&rsquo;s chapter <em>Filtering and Fourier Analysis</em> in his 2014 book 
  <a href="https://mitpress.mit.edu/9780262525855/an-introduction-to-the-event-related-potential-technique/">An Introduction to the Event-Related Potential Technique</a>.
    </div>
  </label>
</div>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>What if I have really sweaty participants?</span>
      <span>↕</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      Ultimately, the quality of the data you collect will dictate the quality of the data in your study. What I mean by this is, although all of the processes outlined in this tutorial can improve things somewhat, if you start with really cruddy data, you&rsquo;ll still finish with really cruddy data. So, what can you do to prevent tonnes of slow drift in your data? First, you want to make sure that your participants are kept as cool as possible. If you have air conditioning in your EEG lab, turn this on before participants arrive and (if possible) between study blocks. Make sure that before you start the capping process your participants take off coats and jumpers (particularly hoodies or items of clothing that will be difficult to take off once they have an EEG cap on their head, even if the do get too hot). Offer your participants water to drink during the session. Finally - and often overlooked - ensure your participants are as relaxed as they can be. Never underestimate the importance of relaxed participants for good data quality. Participants who are tense, stressed, worried about the task, or uncomfortable with the process will sweat more, have tenser shoulder and neck muscles, and overall perform worse on any task you set them. It is completely within you control to make sure participants understand what&rsquo;s happening, don&rsquo;t feel immense pressure to perform perfectly, and feel comfortable to ask questions. This is something I&rsquo;ve so often seen stressed undergrad and MA students overlook, fixated on getting through the sheer quantity of data acquisition they have to complete. But trust me, you (and your participants) will thank yourself for taking the time to keep them happy.
    </div>
  </label>
</div>
<br>
<h5 id="ufootnotesu">
  <u>Footnotes</u>
  <a class="anchor" href="#ufootnotesu">#</a>
</h5>
<h5 id="1-high-pass-filters-use-involve-computations-that-require-a-couple-of-seconds-of-data-to-operate-correctly-if-you-apply-the-filter-to-your-epoched-data-you-stand-a-chance-of-introducing-artifacts-at-the-beginning-and-end-of-your-epoch">
  (1) High-pass filters use involve computations that require a couple of seconds of data to operate correctly. If you apply the filter to your epoched data, you stand a chance of introducing artifacts at the beginning and end of your epoch
  <a class="anchor" href="#1-high-pass-filters-use-involve-computations-that-require-a-couple-of-seconds-of-data-to-operate-correctly-if-you-apply-the-filter-to-your-epoched-data-you-stand-a-chance-of-introducing-artifacts-at-the-beginning-and-end-of-your-epoch">#</a>
</h5>
<!-- Heading to link to -->
<h5 id="Section_further_down">(2) When you set a cut-off frequency (e.g., 0.1Hz), the power at this frequency does not immediately drop to 0. Instead, there is a gradual reduction of power over a range of frequencies as specified by the roll-off. Changing this roll-off changes show sharply the filter cuts off power at these frequencies, and higher roll-offs (i.e., 24db/oct, 48db/oct) are sharper in terms of the power cut-off than lower roll-offs (e.g., 12dB/oct). Very sharp roll-offs can cause artifacts, so if you're unsure of what you're doing here, it's safest to 1. go through the recommended reading above, and 2. stick to a softer roll-off (e.g., 12dB/oct). </h2>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  </main>

  
</body>
</html>












